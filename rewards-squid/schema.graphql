type Account @entity {
  "Account address"
  id: ID!
  transfersTo: [Transfer!] @derivedFrom(field: "to")
  transfersFrom: [Transfer!] @derivedFrom(field: "from")
  rewards: [RewardEvent!]! @derivedFrom(field: "account")
}

type Transfer @entity {
  id: ID!
  blockNumber: Int! @index
  timestamp: DateTime! @index
  extrinsicHash: String @index
  from: Account!
  to: Account!
  amount: BigInt! @index
  fee: BigInt! # fee is calculated at the best effort and may be zero for some old extrinsics
}

type Operator @entity {
  id: ID! @index
  signingKey: String! @index
  operatorOwner: String @index
  orderingId: Int! @index
  currentDomainId: Int
  nextDomainId: Int
  minimumNominatorStake: BigInt
  nominationTax: Int
  currentTotalStake: BigInt
  currentEpochRewards: BigInt
  totalShares: BigInt
  nominatorAmount: Int! @index
  nominators: [Nominator!]!
    @derivedFrom(field: "operator")
    @cardinality(value: 1000)
  status: String
  updatedAt: BigInt @index
}

type Nominator @entity {
  id: ID! @index
  operator: Operator!
  account: Account!
  shares: BigInt
  updatedAt: BigInt
}

type RewardEvent @entity {
  id: ID! @index
  indexInBlock: Int!
  name: String!
  timestamp: DateTime! @index
  phase: String!
  pos: Int
  blockNumber: Int! @index
  extrinsicHash: String @index
  account: Account
  amount: BigInt
}
